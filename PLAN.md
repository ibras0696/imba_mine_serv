# Проектный план: Forge 1.20.1 Server Toolkit

> Документ на русском, без кода — только мозговой план.

---

## 0. Формат проекта

**Идея:** репозиторий, который позволяет любому админу:

* поднять Forge 1.20.1 сервер одной командой;
* конфигурировать его через `.env`;
* класть моды в понятные папки;
* запускать всё через Docker Compose + `make`;
* без CI/CD и лишней магии.

---

## 1. Определение требований

### 1.1. Функциональные

1. Поднять **один Minecraft Forge 1.20.1 сервер** в контейнере.
2. Конфигурировать сервер через переменные окружения: порт, EULA, имя сервера, сложность, количество игроков, выделенная память.
3. Подключать **серверные моды** из отдельной папки.
4. Иметь отдельный список **клиентских модов** (чтобы игрокам было понятно, что ставить).
5. Управлять через `make`:
   * старт;
   * стоп;
   * рестарт;
   * логи;
   * чистка (удаление контейнеров/томов).
6. Возможность запускать на:
   * локальной машине (Windows/Linux/macOS);
   * удалённом Linux-сервере (VPS/dedicated).

### 1.2. Нефункциональные

1. Минимум ручных действий после клонирования репо.
2. Документация такова, чтобы **новичок по Docker смог справиться**.
3. Осознанный отказ от CI/CD, Kubernetes и прочего.

---

## 2. Архитектурные решения

### 2.1. Стек

* **Docker** + **Docker Compose** ([Docker Documentation][1])
* **Forge 1.20.1** (версия recommended) ([Forge Files][2])
* **Java 17 (OpenJDK 17)** ([openjdk.org][3])

### 2.2. Основные принципы

1. **Immutable образ**, но:
   * мир и конфиги → в volume / на хосте;
   * моды можно менять без пересборки образа (монтируем папку).
2. **Одна точка правды для настроек** — `.env`.
3. **Чёткое разделение**: server mods / client mods / configs.
4. Один `docker-compose.yml` без лишних сервисов.

---

## 3. Структура репозитория (логический дизайн)

Пока только концепция:

* `docker/` — всё, что связано с образом сервера;
* `compose/` — docker-compose;
* `mods/` — моды и их списки;
* `config/` — конфиги;
* `env/` — env-файлы (пример / локал / прод);
* `docs/` — документация (в т.ч. модпак);
* `git/` — всё для git (хуки, шаблоны, настройки);
* `Makefile` — CLI-интерфейс;
* `README.md` — основной вход.

---

## 4. Дизайн управления конфигами и `.env`

### 4.1. Какие параметры выносим

Минимум:

* `SERVER_PORT`
* `MEMORY_MIN`, `MEMORY_MAX`
* `EULA`
* `MAX_PLAYERS`
* `DIFFICULTY`
* `ONLINE_MODE`
* `SERVER_NAME`

Расширяемый набор:

* `LEVEL_NAME`
* `VIEW_DISTANCE`
* `ALLOW_NETHER`, `PVP`, `ENABLE_COMMAND_BLOCK`

### 4.2. Политика

* `env/.env.example` — шаблон, всегда актуальный;
* `env/local.env` — для локальных тестов;
* `env/production.env` — для удалённого сервера.

В документации описать:

1. Как копировать `.env.example`.
2. Какие поля надо менять минимум, чтобы запуститься.

---

## 5. Дизайн управления модами

### 5.1. Разделение

* `mods/server/` — `.jar`, которые нужны серверу и игрокам.
* `mods/client/` — списки/описания:
  * `client-mods.md`
  * `client-mods.json` (опционально — имя, версия, ссылка CurseForge).

### 5.2. Документация

В `docs/modpack.md`:

* таблица модов;
* секции:
  * Server-side required;
  * Client-only;
  * Optional performance mods.

### 5.3. Политика обновления

1. Новый мод — обязательно запись в `docs/modpack.md` с версией.
2. Обновление — новый `.jar` + фиксация версии в документации.
3. Future work: полуавтомат через API CurseForge/Modrinth.

---

## 6. Makefile-API (без реализации)

### 6.1. Базовые команды

* `make up` — поднять сервер;
* `make down` — остановить;
* `make restart` — рестарт;
* `make logs` — логи;
* `make ps` — статус;
* `make clean` — снести контейнеры и тома;
* `make rebuild` — пересборка образа.

### 6.2. Расширенные (будущее)

* `make backup` — архив мира и конфигов;
* `make restore` — восстановление;
* `make update-mods` — полуавтомат обновления.

---

## 7. План тестирования (до кода)

### 7.1. Сценарии

1. **Чистый запуск без модов** — копируем `.env`, меняем порт/название, запускаем, заходим с ванильным клиентом.
2. **Запуск с модами** — кладём комплект RPG/Tech модов, проверяем, что сервер и клиент стартуют без ошибок.
3. **Ошибка в конфиге** — неправильная сложность, убеждаемся, что падение с понятной ошибкой.
4. **Перенос проекта** — клонируем на новый сервер, копируем `.env`/мир/моды, проверяем запуск.

### 7.2. Среды

* локальный dev: Windows + Docker Desktop ([Docker][4]);
* удалённый сервер: Ubuntu + Docker Engine ([Docker Documentation][1]).

---

## 8. README: структура

Перед реализацией решаем, что будет в README:

1. Описание проекта;
2. Требования (Docker, Compose, ресурсы);
3. Быстрый старт;
4. Структура проекта;
5. Работа с `.env`;
6. Работа с модами;
7. Типовые проблемы;
8. Ссылки на оф. доки (Docker, Compose, Forge, OpenJDK).

---

## 9. Этапы разработки (роадмап)

### Этап 0 — исследования

* выбрать версию Forge (recommended);
* зафиксировать Java (OpenJDK 17);
* собрать минимальный список модов;
* решить ОС хоста для прод.

**Артефакт:** `docs/decisions.md`.

### Этап 1 — скелет репо

* создать папки;
* добавить пустые файлы (README, env, docs);
* описать структуру в README.

**Критерий:** видно структуру, понятно что где будет.

### Этап 2 — конфигурация и `.env`

* утвердить список переменных;
* описать обязательные/опциональные/дефолты;
* прописать правила (не коммитим реальные env, обновляем example).

**Критерий:** по `.env.example` новичок всё понимает.

### Этап 3 — логика Docker/Compose (без кода)

* описать структуру образа;
* какие директории в volumes;
* env-переменные в Compose;
* название сервиса.

**Критерий:** любой девопс напишет Dockerfile и compose по документу.

### Этап 4 — Makefile-интерфейс

* описать команды и поведение;
* продумать `make clean` (не удалить лишнее);
* сценарии: новый пользователь, обновление сборки.

**Критерий:** `make` воспринимается как UX-слой.

### Этап 5 — документация по модам

* описать `docs/modpack.md`;
* разбить моды (RPG, Magic, Tech, Optimization);
* формат таблиц (имя, server/client/both, версия, ссылка).

**Критерий:** игрок понимает, что ставить.

### Этап 6 — тестирование и эксплуатация

* матрица тестов (сценарии из раздела 7);
* чек-лист: первый запуск, после добавления модов, после изменения `.env`.

**Критерий:** список проверок не зависит от реализации.

---

## 10. Дальнейшие шаги

1. На основе плана — оформить `PLAN.md` (готово).
2. Далее — тех. дизайн (Docker, Compose, Makefile) и реализация.

Если нужно — можно расширить документ отдельными приложениями (например, `docs/modpack.md` с таблицами модов).

---

[1]: https://docs.docker.com/?utm_source=chatgpt.com "Docker Docs"  
[2]: https://files.minecraftforge.net/net/minecraftforge/forge/index_1.20.1.html?utm_source=chatgpt.com "Downloads for Minecraft Forge - MC 1.20.1"  
[3]: https://openjdk.org/projects/jdk/17/?utm_source=chatgpt.com "JDK 17"  
[4]: https://www.docker.com/products/docker-desktop/?utm_source=chatgpt.com "Docker Desktop"  
[5]: https://docs.docker.com/compose/?utm_source=chatgpt.com "Docker Compose"
