# Docker Compose для запуска Forge 1.20.1 сервера.
# Вся конфигурация подтягивается из env/local.env или env/production.env.

services:
  minecraft:
    container_name: forge-server
    build:
      context: ..
      dockerfile: docker/Dockerfile
      args:
        MC_VERSION: "1.20.1"
    restart: unless-stopped

    ports:
      - "${SERVER_PORT:-25565}:25565"

    environment:
      EULA: "${EULA}"
      TYPE: "FORGE"
      VERSION: "${MC_VERSION:-1.20.1}"
      INIT_MEMORY: "${MEMORY_MIN}"
      MAX_MEMORY: "${MEMORY_MAX}"
      SERVER_NAME: "${SERVER_NAME}"
      DIFFICULTY: "${DIFFICULTY}"
      MAX_PLAYERS: "${MAX_PLAYERS}"
      ONLINE_MODE: "${ONLINE_MODE}"
      LEVEL_NAME: "${LEVEL_NAME}"
      VIEW_DISTANCE: "${VIEW_DISTANCE}"
      ALLOW_NETHER: "${ALLOW_NETHER}"
      PVP: "${PVP}"
      ENABLE_COMMAND_BLOCK: "${ENABLE_COMMAND_BLOCK}"

    volumes:
      # Миры и игроки
      - ../data/world:/data/world
      # Конфиги модов
      - ../config:/data/config
      # Серверные моды (папка mods/server внутри репозитория)
      - ../mods/server:/data/mods
      # Логи сервера (полезно для отладки)
      - ../logs:/data/logs
